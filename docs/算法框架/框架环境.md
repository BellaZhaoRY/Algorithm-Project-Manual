---
sort: 2
---



# 框架环境



* [算法开发手册](https://kg-nlp.github.io/Algorithm-Project-Manual)

* [个人知乎](https://zhihu.com/people/zhangyj-n)



## Pytorch

### pytorch 1.7.0

> 算法框架的基础镜像

> 这个版本的cuda无法满足A800的显卡使用要求

```bash
docker run -it -d --name pytorch_env -p 8085:22 -p 8040:8040 -p 8030:8030 -p 8020:8020 --gpus all --shm-size 64g --restart=always pytorch/pytorch:1.7.0-cuda11.0-cudnn8-devel /bin/bash

apt-get update
apt-get install -y vim
apt-get install -y openssh-server
service ssh restart
root@b9d22b100490:/opt/conda/bin# ln -s /opt/conda/bin/python /usr/local/bin/python
root@b9d22b100490:/opt/conda/bin# ln -s /opt/conda/bin/pip /usr/local/bin/pip

```

> 重新commit 以及启动,启动时注意外挂数据卷,以及多暴露端口

```bash
docker commit pytorch_env registry.cn-beijing.aliyuncs.com/zhangyj-n/pytorch:1.7.0-cuda11.0-cudnn8-devel

docker run -it -d --name pytorch_env -p 8085:22  -p 8040:8040 -p 8030:8030 -p 8020:8020 -p 8010:8010 -p 8000:8000 \
-v /home/zhangyj/Algorithm_Frame:/home/Algorithm_Frame \
--shm-size 64g --restart=always --gpus all  -e NVIDIA_VISIBLE_DEVICES=all registry.cn-beijing.aliyuncs.com/zhangyj-n/pytorch:1.7.0-cuda11.0-cudnn8-devel /bin/bash
```



>  如果缺少动态库,参考工程内容 [🔨开发问题](https://kg-nlp.github.io/Algorithm-Project-Manual/工程内容/开发问题.html)

```bash
示例:
find / -name libcudart.so.10.2
/usr/local/cuda-10.2/targets/x86_64-linux/lib/libcudart.so.10.2
拷贝至 /usr/lib/ 
```



### pytorch 1.13.0

* smp比赛镜像制作,custom环境

```bash
registry.cn-beijing.aliyuncs.com/zhangyj-n/pytorch:1.13.0-cuda11.0-cudnn8-simple

docker exec -it smp_env bash  # 进入容器
apt-get update
apt-get install -y vim
apt-get install -y openssh-server  # 安装ssh服务
vi /etc/ssh/sshd_config  # 修改ssh配置文件如下(全部替换)
ggdG
"""
ChallengeResponseAuthentication no
UsePAM yes
X11Forwarding yes
PrintMotd no
AcceptEnv LANG LC_*
Subsystem    sftp    /usr/lib/openssh/sftp-server
PubkeyAuthentication yes
RSAAuthentication yes
PermitRootLogin yes
"""

service ssh restart  # 启动
passwd root  # 修改密码
root
cat /etc/passwd

root@b9d22b100490:/opt/conda/bin# ln -s /opt/conda/bin/python /usr/local/bin/python
root@b9d22b100490:/opt/conda/bin# ln -s /opt/conda/bin/pip /usr/local/bin/pip

which python  # 查找python解析器路径,使用pycharm远程连接时需要

apt-get install curl -y
apt-get install zip -y
apt-get install unzip -y

生成新镜像
docker commit -m 'update' registry.cn-beijing.aliyuncs.com/zhangyj-n/pytorch:1.13.0-cuda11.0-cudnn8-0823
```

> 已安装pip

```tex
transformers==4.31.0
modelscope==1.8.3
numpy==1.20.3
sentencepiece
torch==1.13.0
accelerate==0.21.0

python-docx==0.8.11
fastapi==0.101.1
openpyxl==3.1.2

elasticsearch==7.10.1
pymilvus==1.1.2
faiss-gpu==1.7.2
pdfplumber==0.10.2
pandas==2.0.3
```



> 启动

```bash
docker run -it -d --name custom_env \
-p 8015:22  -p 8001:8001 -p 8002:8002 -p 8003:8003 -p 8004:8004 -p 8005:8005 \
-v /data/zhangyj/custom_project:/workspace/custom_project \
--gpus all --shm-size 64g --restart=always \
-e NVIDIA_VISIBLE_DEVICES=all \
registry.cn-beijing.aliyuncs.com/zhangyj-n/pytorch:1.13.0-cuda11.0-cudnn8-0823 /bin/bash
```





## Paddle



* 可视化日志

```
```







## jupyter





















































